[
  {
    "Id": "246166",
    "ThreadId": "72132",
    "Html": "<p>I have a product that uses an activex wrapper and an ocx control.&nbsp; I also have the source for the control in c++.&nbsp; I was able to successfully convert it into VS2008 pro.&nbsp; With almost no changes to the source I was able to successfully compile with no warnings or errors.&nbsp; It is a MFC shared dll.&nbsp; I checked out the tlb and it looks good with all the events and functions listed and an embedded manifest.&nbsp; I used aximp to create a new activex wrapper from the tlb.&nbsp; However, when I try to register the ocx I get the dreaded 0x80040200 error.&nbsp; I have processmon but have seen no obvious issues with registration (not very familiar with that tool though).&nbsp; I know about Vista and UAC.&nbsp; I can successfully register and use the original ocx binary with an aximp generated wrapper.&nbsp; It is in my current product with over 1000 copies sold to date.&nbsp; I guess my questions are:</p>\r\n<p>1 Any thoughts&nbsp;or ideas?</p>\r\n<p>2. Is there a tool that will let me step through the registration process to see where it fails?</p>\r\n<p>3. Is there a tool that will let me see what is in the ocx file?</p>\r\n<p>Any comments are very much appreciated!</p>\r\n<p>Mark</p>",
    "PostedDate": "2009-10-15T11:49:57.013-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "247219",
    "ThreadId": "72132",
    "Html": "<p>Hey Mark, could you let me know your repro steps? It would help us to identify the problem or give you a solution.</p>",
    "PostedDate": "2009-10-19T02:34:21.333-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "247447",
    "ThreadId": "72132",
    "Html": "<p><br>Thanks for your reply.&nbsp; I went back over the repro steps from the beginning to verify my previous results and strangely enough was able to successfully register the .ocx and generate the activex wrapper.&nbsp; The only difference in both test regressions was that I did a VS2008 update between the 2 test regressions.&nbsp; It looks like now I have a c++ debug issue to figure out.&nbsp; I can now see the registration with OLEView.&nbsp; I have included the steps from the beginning below:</p>\r\n<p>The original c++ code was developed using the Microsoft compiler 6.0.&nbsp; Here are the original build settings:</p>\r\n<p>Win32 ANSI Debug Tab C/C++:<br>&nbsp; /nologo /MDd /W4 /Gm /Gi /GX /ZI /Od /D &quot;_DEBUG&quot; /D &quot;VC_EXTRALEAN&quot; /D &quot;_WINDOWS&quot; /D &quot;_AFXCTL&quot; /D &quot;_WINDLL&quot; /D &quot;_AFXDLL&quot; /D &quot;_WIN32&quot; /Fr&quot;.\\Debug/&quot; /Fp&quot;.\\Debug/Midiio2k.pch&quot; /Yu&quot;stdafx.h&quot; /Fo&quot;.\\Debug/&quot; /Fd&quot;.\\Debug/&quot; /FD /c <br>Win32 ANSI Debug Tab Link:<br>&nbsp; winmm.lib /nologo /subsystem:windows /dll /incremental:yes /pdb:&quot;.\\Debug/midiio2k.pdb&quot; /debug /machine:IX86 /def:&quot;.\\midiio2k.def&quot; /out:&quot;.\\Debug\\midiio2k.ocx&quot; /implib:&quot;.\\Debug/midiio2k.lib&quot; <br>Win32 ANSI Debug Tab Resources:<br>&nbsp; /l 0x409 /fo&quot;.\\Debug/MIDIIO2K.res&quot; /i &quot;$(OUTDIR)&quot; /d &quot;_DEBUG&quot; /d &quot;VC_EXTRALEAN&quot; /d &quot;_WIN32&quot; /d &quot;_AFXDLL&quot; <br>Win32 ANSI Debug Tab MIDL:<br>&nbsp; /nologo /D &quot;_DEBUG&quot; /D &quot;VC_EXTRALEAN&quot; /D &quot;_WIN32&quot; /mktyplib203 /win32 <br>Win32 ANSI Debug Tab Browser:<br>&nbsp; /nologo /o&quot;.\\Debug\\midiio2k.bsc&quot;</p>\r\n<p>I opened the project in VS2008 Professional.&nbsp; Visual Studio converted the&nbsp; project with conversion wizard.&nbsp; The conversion was successful with one warning about the solution and these comments:</p>\r\n<p>Conversion Issues - midiio2k.vcproj: <br>Web deployment to the local IIS server is no longer supported. The Web Deployment build tool has been removed from your project settings. <br>Project file successfully backed up as 'C:\\Audio Recording\\MIDI\\Librarian\\MIDIIO_2.1035\\Source\\OCX32\\midiio2k.vcproj.8.00.old'. <br>Project upgraded successfully. <br>This application has been updated to include settings related to the User Account Control (UAC) feature of Windows Vista. By default, when run on Windows Vista with UAC enabled, this application is marked to run with the same privileges as the process that launched it. This marking also disables the application from running with virtualization. You can change UAC related settings from the Property Pages of the project.</p>\r\n<p>When I compiled I got these warnings:</p>\r\n<p>Warning&nbsp;1&nbsp;command line warning MIDL1007 : switch specified more than once on command line : mktyplib203&nbsp;midl&nbsp;midiio2k<br>Warning&nbsp;2&nbsp;command line warning MIDL1007 : switch specified more than once on command line : nologo&nbsp;midl&nbsp;midiio2k<br>Warning&nbsp;3&nbsp;warning C4918: 'a' : invalid character in pragma optimization list&nbsp;c:\\audio recording\\midi\\librarian\\midiio_2.1035\\source\\ocx32\\compiler.h&nbsp;294&nbsp;midiio2k<br>Warning&nbsp;4&nbsp;warning C4918: 'i' : invalid character in pragma optimization list&nbsp;c:\\audio recording\\midi\\librarian\\midiio_2.1035\\source\\ocx32\\compiler.h&nbsp;294&nbsp;midiio2k<br>Warning&nbsp;5&nbsp;warning C4918: 'p' : invalid character in pragma optimization list&nbsp;c:\\audio recording\\midi\\librarian\\midiio_2.1035\\source\\ocx32\\compiler.h&nbsp;294&nbsp;midiio2k<br>Warning&nbsp;6&nbsp;warning C4918: 'w' : invalid character in pragma optimization list&nbsp;c:\\audio recording\\midi\\librarian\\midiio_2.1035\\source\\ocx32\\compiler.h&nbsp;294&nbsp;midiio2k<br>Warning&nbsp;7&nbsp;warning C4918: 'x' : invalid character in pragma optimization list&nbsp;c:\\audio recording\\midi\\librarian\\midiio_2.1035\\source\\ocx32\\compiler.h&nbsp;295&nbsp;midiio2k<br>Warning&nbsp;8&nbsp;warning C4535: calling _set_se_translator() requires /EHa&nbsp;c:\\audio recording\\midi\\librarian\\midiio_2.1035\\source\\ocx32\\midiictl.cpp&nbsp;466&nbsp;midiio2k<br>Warning&nbsp;9&nbsp;warning C4535: calling _set_se_translator() requires /EHa&nbsp;c:\\audio recording\\midi\\librarian\\midiio_2.1035\\source\\ocx32\\midioctl.cpp&nbsp;554&nbsp;midiio2k<br>Warning&nbsp;10&nbsp;warning LNK4222: exported symbol 'DllCanUnloadNow' should not be assigned an ordinal&nbsp;c:\\Audio Recording\\MIDI\\Librarian\\MIDIIO_2.1035\\Source\\OCX32\\midiio2k.def&nbsp;1&nbsp;midiio2k<br>Warning&nbsp;11&nbsp;warning LNK4222: exported symbol 'DllGetClassObject' should not be assigned an ordinal&nbsp;c:\\Audio Recording\\MIDI\\Librarian\\MIDIIO_2.1035\\Source\\OCX32\\midiio2k.def&nbsp;1&nbsp;midiio2k<br>Warning&nbsp;12&nbsp;warning LNK4222: exported symbol 'DllRegisterServer' should not be assigned an ordinal&nbsp;c:\\Audio Recording\\MIDI\\Librarian\\MIDIIO_2.1035\\Source\\OCX32\\midiio2k.def&nbsp;1&nbsp;midiio2k<br>Warning&nbsp;13&nbsp;warning LNK4222: exported symbol 'DllUnregisterServer' should not be assigned an ordinal&nbsp;c:\\Audio Recording\\MIDI\\Librarian\\MIDIIO_2.1035\\Source\\OCX32\\midiio2k.def&nbsp;1&nbsp;midiio2k</p>\r\n<p>I removed these additional command switches for the linker:</p>\r\n<p>winmm.lib /nologo /subsystem:windows /dll /incremental:yes /pdb:&quot;.\\Debug/midiio2k.pdb&quot; /debug /machine:IX86 /def:&quot;.\\midiio2k.def&quot; /out:&quot;.\\Debug\\midiio2k.ocx&quot; /implib:&quot;.\\Debug/midiio2k.lib&quot;</p>\r\n<p>I removed these additional command switches for MIDL:</p>\r\n<p>/nologo /D &quot;_DEBUG&quot; /D &quot;VC_EXTRALEAN&quot; /D &quot;_WIN32&quot; /mktyplib203 /win32</p>\r\n<p>I removed these additional command switches for Resources:</p>\r\n<p>/l 0x409 /fo&quot;.\\Debug/MIDIIO2K.res&quot; /i &quot;$(OUTDIR)&quot; /d &quot;_DEBUG&quot; /d &quot;VC_EXTRALEAN&quot; /d &quot;_WIN32&quot; /d &quot;_AFXDLL&quot;</p>\r\n<p>I removed these additional command switches for Browse Information:</p>\r\n<p>/nologo /o&quot;.\\Debug\\midiio2k.bsc&quot;</p>\r\n<p>The new command switches were:</p>\r\n<p>Win32 ANSI Debug Tab C/C++:<br>/D &quot;_DEBUG&quot; /D &quot;VC_EXTRALEAN&quot; /D &quot;_WINDOWS&quot; /D &quot;_AFXCTL&quot; /D &quot;_WINDLL&quot; /D &quot;_AFXDLL&quot; /D &quot;_WIN32&quot; /D &quot;_VC80_UPGRADE=0x0600&quot; /Gm /EHa /MDd /Yu&quot;stdafx.h&quot; /Fp&quot;.\\Debug/midiio2k.pch&quot; /Fo&quot;.\\Debug/&quot; /Fd&quot;.\\Debug/&quot; /FR&quot;.\\Debug/&quot; /W4 /nologo /c /ZI /TP /errorReport:prompt<br>Win32 ANSI Debug Tab Link:<br>/OUT:&quot;.\\Debug\\midiio2k.ocx&quot; /INCREMENTAL /NOLOGO /LIBPATH:&quot;winmm.lib&quot; /DLL /MANIFEST /MANIFESTFILE:&quot;.\\Debug\\midiio2k.ocx.intermediate.manifest&quot; /MANIFESTUAC:&quot;level='asInvoker' uiAccess='false'&quot; /DEF:&quot;.\\midiio2k.def&quot; /DEBUG /PDB:&quot;.\\Debug/midiio2k.pdb&quot; /SUBSYSTEM:WINDOWS /DYNAMICBASE:NO /IMPLIB:&quot;.\\Debug/midiio2k.lib&quot; /ERRORREPORT:PROMPT winmm.libWin32 ANSI Debug Tab Resources:<br>Win32 ANSI Debug Tab MIDL:<br>/D &quot;_DEBUG&quot; /D &quot;VC_EXTRALEAN&quot; /D &quot;_WIN32&quot; /mktyplib203 /nologo /char signed /env win32&nbsp; /tlb &quot;.\\Debug/midiio2k.tlb&quot;<br>Win32 ANSI Debug Tab Browser:<br>/nologo /o &quot;.\\Debug\\midiio2k.bsc&quot;</p>\r\n<p>When I compiled I got these warnings:</p>\r\n<p>Warning&nbsp;1&nbsp;warning C4918: 'a' : invalid character in pragma optimization list&nbsp;c:\\audio recording\\midi\\librarian\\midiio_2.1035\\source\\ocx32\\compiler.h&nbsp;294&nbsp;midiio2k<br>Warning&nbsp;2&nbsp;warning C4918: 'i' : invalid character in pragma optimization list&nbsp;c:\\audio recording\\midi\\librarian\\midiio_2.1035\\source\\ocx32\\compiler.h&nbsp;294&nbsp;midiio2k<br>Warning&nbsp;3&nbsp;warning C4918: 'p' : invalid character in pragma optimization list&nbsp;c:\\audio recording\\midi\\librarian\\midiio_2.1035\\source\\ocx32\\compiler.h&nbsp;294&nbsp;midiio2k<br>Warning&nbsp;4&nbsp;warning C4918: 'w' : invalid character in pragma optimization list&nbsp;c:\\audio recording\\midi\\librarian\\midiio_2.1035\\source\\ocx32\\compiler.h&nbsp;294&nbsp;midiio2k<br>Warning&nbsp;5&nbsp;warning C4918: 'x' : invalid character in pragma optimization list&nbsp;c:\\audio recording\\midi\\librarian\\midiio_2.1035\\source\\ocx32\\compiler.h&nbsp;295&nbsp;midiio2k<br>Warning&nbsp;6&nbsp;warning LNK4222: exported symbol 'DllCanUnloadNow' should not be assigned an ordinal&nbsp;c:\\Audio Recording\\MIDI\\Librarian\\MIDIIO_2.1035\\Source\\OCX32\\midiio2k.def&nbsp;1&nbsp;midiio2k<br>Warning&nbsp;7&nbsp;warning LNK4222: exported symbol 'DllGetClassObject' should not be assigned an ordinal&nbsp;c:\\Audio Recording\\MIDI\\Librarian\\MIDIIO_2.1035\\Source\\OCX32\\midiio2k.def&nbsp;1&nbsp;midiio2k<br>Warning&nbsp;8&nbsp;warning LNK4222: exported symbol 'DllRegisterServer' should not be assigned an ordinal&nbsp;c:\\Audio Recording\\MIDI\\Librarian\\MIDIIO_2.1035\\Source\\OCX32\\midiio2k.def&nbsp;1&nbsp;midiio2k<br>Warning&nbsp;9&nbsp;warning LNK4222: exported symbol 'DllUnregisterServer' should not be assigned an ordinal&nbsp;c:\\Audio Recording\\MIDI\\Librarian\\MIDIIO_2.1035\\Source\\OCX32\\midiio2k.def&nbsp;1&nbsp;midiio2k</p>\r\n<p>I took out 'a', 'i', 'p', 'w', 'x' from the pragma (optimization disabled anyway)</p>\r\n<p>I changed the .DEF file from:</p>\r\n<p>; midiio2k.def : Declares the module parameters.</p>\r\n<p>LIBRARY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MIDIIO2K.OCX</p>\r\n<p>EXPORTS<br>&nbsp;&nbsp;&nbsp; DllCanUnloadNow&nbsp;&nbsp;&nbsp;&nbsp; @1 PRIVATE<br>&nbsp;&nbsp;&nbsp; DllGetClassObject&nbsp;&nbsp; @2 PRIVATE<br>&nbsp;&nbsp;&nbsp; DllRegisterServer&nbsp;&nbsp; @3 PRIVATE<br>&nbsp;&nbsp;&nbsp; DllUnregisterServer @4 PRIVATE<br>;(see 1.20.106)</p>\r\n<p>;EXPORTS<br>;&nbsp;&nbsp;&nbsp; DllCanUnloadNow&nbsp;&nbsp;&nbsp;&nbsp; @1<br>;&nbsp;&nbsp;&nbsp; DllGetClassObject&nbsp;&nbsp; @2<br>;&nbsp;&nbsp;&nbsp; DllRegisterServer&nbsp;&nbsp; @3<br>;&nbsp;&nbsp;&nbsp; DllUnregisterServer @4<br>; generates compile errors in visual c+ 6.0</p>\r\n<p>to:</p>\r\n<p>; midiio2k.def : Declares the module parameters.</p>\r\n<p>LIBRARY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MIDIIO2K.OCX</p>\r\n<p>EXPORTS<br>&nbsp;&nbsp;&nbsp; DllCanUnloadNow&nbsp;&nbsp;&nbsp;&nbsp; PRIVATE<br>&nbsp;&nbsp;&nbsp; DllGetClassObject&nbsp;&nbsp; PRIVATE<br>&nbsp;&nbsp;&nbsp; DllRegisterServer&nbsp;&nbsp; PRIVATE<br>&nbsp;&nbsp;&nbsp; DllUnregisterServer PRIVATE<br>;(see 1.20.106)</p>\r\n<p>;EXPORTS<br>;&nbsp;&nbsp;&nbsp; DllCanUnloadNow&nbsp;&nbsp;&nbsp;&nbsp; @1<br>;&nbsp;&nbsp;&nbsp; DllGetClassObject&nbsp;&nbsp; @2<br>;&nbsp;&nbsp;&nbsp; DllRegisterServer&nbsp;&nbsp; @3<br>;&nbsp;&nbsp;&nbsp; DllUnregisterServer @4<br>; generates compile errors in visual c+ 6.0</p>\r\n<p>When I recompiled I got no warnings and no errors.</p>\r\n<p>The build output was:</p>\r\n<p>1&gt;------ Rebuild All started: Project: midiio2k, Configuration: ANSI Debug Win32 ------<br>1&gt;Deleting intermediate and output files for project 'midiio2k', configuration 'ANSI Debug|Win32'<br>1&gt;Creating Type Library...<br>1&gt;Processing .\\midiio2k.odl<br>1&gt;midiio2k.odl<br>1&gt;Processing C:\\Program Files\\Microsoft SDKs\\Windows\\v6.0A\\\\include\\oaidl.idl<br>1&gt;oaidl.idl<br>1&gt;Processing C:\\Program Files\\Microsoft SDKs\\Windows\\v6.0A\\\\include\\objidl.idl<br>1&gt;objidl.idl<br>1&gt;Processing C:\\Program Files\\Microsoft SDKs\\Windows\\v6.0A\\\\include\\unknwn.idl<br>1&gt;unknwn.idl<br>1&gt;Processing C:\\Program Files\\Microsoft SDKs\\Windows\\v6.0A\\\\include\\wtypes.idl<br>1&gt;wtypes.idl<br>1&gt;Processing C:\\Program Files\\Microsoft SDKs\\Windows\\v6.0A\\\\include\\basetsd.h<br>1&gt;basetsd.h<br>1&gt;Processing C:\\Program Files\\Microsoft SDKs\\Windows\\v6.0A\\\\include\\guiddef.h<br>1&gt;guiddef.h<br>1&gt;Processing C:\\Program Files\\Microsoft SDKs\\Windows\\v6.0A\\\\include\\oaidl.acf<br>1&gt;oaidl.acf<br>1&gt;Compiling...<br>1&gt;STDAFX.CPP<br>1&gt; <br>1&gt;----------------------------------------------------------------------<br>1&gt;COMPILER.H: PROGRAM WARNING 6771, sometimes verify project settings are accurate (see _project settings.txt)<br>1&gt;COMPILER.H: PROGRAM WARNING 6772, sometimes verify project settings use level 4 warnings. Specify /GX.<br>1&gt;COMPILER.H: PROGRAM WARNING 6773, sometimes verify project settings uses only certain optimization. (see COMPILER.H).<br>1&gt;COMPILER.H: PROGRAM WARNING 6780, sometimes Rebuild-All with DEBUGTEST configuration.<br>1&gt;COMPILER.H: PROGRAM WARNING 6781, sometimes verify code with conditions related to C4706 warnings but are not shown (see PRAGMA.H and 1.20.125)<br>1&gt;COMPILER.H: PROGRAM WARNING 6782, sometimes verify code does not mix 'false' and 'FALSE' (see 1.20.127)<br>1&gt;COMPILER.H: PROGRAM WARNING 6783, always fix IDs that class wizard changes (see 2.00.204)<br>1&gt;COMPILER.H: PROGRAM WARNING 6790, formatted most source code with tabs as 4 spaces in options (or copy tab character and search/replace it)<br>1&gt;----------------------------------------------------------------------<br>1&gt; WINVER not defined. Defaulting to 0x0600 (Windows Vista)<br>1&gt;Compiling...<br>1&gt;cathelp.cpp<br>1&gt;midiictl.cpp<br>1&gt;midiio.cpp<br>1&gt;midiippg.cpp<br>1&gt;midiiwnd.cpp<br>1&gt;midioctl.cpp<br>1&gt;midioppg.cpp<br>1&gt;midiownd.cpp<br>1&gt;queue.cpp<br>1&gt;Generating Code...<br>1&gt;Compiling resources...<br>1&gt;Microsoft (R) Windows (R) Resource Compiler Version 6.0.5724.0<br>1&gt;Copyright (C) Microsoft Corporation.&nbsp; All rights reserved.<br>1&gt;Compiling manifest to resources...<br>1&gt;Microsoft (R) Windows (R) Resource Compiler Version 6.0.5724.0<br>1&gt;Copyright (C) Microsoft Corporation.&nbsp; All rights reserved.<br>1&gt;Linking...<br>1&gt;&nbsp;&nbsp; Creating library .\\Debug/midiio2k.lib and object .\\Debug/midiio2k.exp<br>1&gt;Embedding manifest...<br>1&gt;Microsoft (R) Windows (R) Resource Compiler Version 6.0.5724.0<br>1&gt;Copyright (C) Microsoft Corporation.&nbsp; All rights reserved.<br>1&gt;Creating browse information file...<br>1&gt;Microsoft Browse Information Maintenance Utility Version 9.00.21022<br>1&gt;Copyright (C) Microsoft Corporation. All rights reserved.<br>1&gt;Build log was saved at &quot;<a>file://c:\\Audio</a> Recording\\MIDI\\Librarian\\MIDIIO_2.1035\\Source\\OCX32\\Debug\\BuildLog.htm&quot;<br>1&gt;midiio2k - 0 error(s), 0 warning(s)<br>========== Rebuild All: 1 succeeded, 0 failed, 0 skipped ==========</p>\r\n<p>The output directory was:</p>\r\n<p>&nbsp;Volume in drive C is SQ004668V05<br>&nbsp;Volume Serial Number is 848A-BC85</p>\r\n<p>&nbsp;Directory of C:\\Audio Recording\\MIDI\\Librarian\\MIDIIO_2.1035\\Source\\OCX32\\Debug</p>\r\n<p>10/19/2009&nbsp; 10:06 AM&nbsp;&nbsp;&nbsp; &lt;DIR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .<br>10/19/2009&nbsp; 10:06 AM&nbsp;&nbsp;&nbsp; &lt;DIR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ..<br>10/19/2009&nbsp; 09:57 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 21,626 BuildLog.htm<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6,314 cathelp.obj<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 cathelp.sbr<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1,193,894 midiictl.obj<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 midiictl.sbr<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 29,120 midiio.obj<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 midiio.sbr<br>10/19/2009&nbsp; 09:57 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8,580,096 midiio2k.bsc<br>10/19/2009&nbsp; 09:57 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1,248 midiio2k.exp<br>10/19/2009&nbsp; 09:57 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2,423,088 midiio2k.ilk<br>10/19/2009&nbsp; 09:57 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1,540 midiio2k.lib<br>10/19/2009&nbsp; 09:57 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1,197,568 midiio2k.ocx<br>10/19/2009&nbsp; 09:57 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 920 midiio2k.ocx.embed.manifest<br>10/19/2009&nbsp; 09:57 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 984 midiio2k.ocx.embed.manifest.res<br>10/19/2009&nbsp; 09:57 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 861 midiio2k.ocx.intermediate.manifest<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 27,262,976 midiio2k.pch<br>10/19/2009&nbsp; 09:57 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6,122,496 midiio2k.pdb<br>10/19/2009&nbsp; 09:57 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 29,388 MIDIIO2K.res<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 21,176 midiio2k.tlb<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 37,505 midiippg.obj<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 midiippg.sbr<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 21,281 midiiwnd.obj<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 midiiwnd.sbr<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3,735,008 midioctl.obj<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 midioctl.sbr<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 37,626 midioppg.obj<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 midioppg.sbr<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 38,037 midiownd.obj<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 midiownd.sbr<br>10/19/2009&nbsp; 09:57 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 66 mt.dep<br>10/19/2009&nbsp; 10:06 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 outtxt.txt<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 144,242 queue.obj<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 queue.sbr<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 467,898 STDAFX.obj<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3,381,306 STDAFX.sbr<br>09/28/2006&nbsp; 10:00 PM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 887,808 vc80.idb<br>09/28/2006&nbsp; 10:00 PM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 872,448 vc80.pdb<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1,092,608 vc90.idb<br>10/19/2009&nbsp; 09:56 AM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2,281,472 vc90.pdb<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 39 File(s)&nbsp;&nbsp;&nbsp;&nbsp; 59,890,600 bytes<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2 Dir(s)&nbsp; 115,918,520,320 bytes free</p>\r\n<p>I was able to successfully register midiio2k.ocx in an admistrator shell using regsvr32.exe</p>\r\n<p>I was able to create the axmidiiolib.dll and midiiolib.dll using aximp.exe</p>\r\n<p>When I ran my app and tried tried to open the midi port I received the error:</p>\r\n<p>Microsoft Visual Studio C Runtime Library has detected a fatal error in Kurzweil Librarian Editor.exe.</p>\r\n<p>Press Break to debug the program or Continue to terminate the program.</p>\r\n<p>This was the call stack:<br>&gt;&nbsp;msvcr90d.dll!_crt_debugger_hook(int _Reserved=2)&nbsp; Line 62&nbsp;C<br>&nbsp;&nbsp;msvcr90d.dll!_invalid_parameter(const wchar_t * pszExpression=0x1014e700, const wchar_t * pszFunction=0x1014eee8, const wchar_t * pszFile=0x1014e2a0, unsigned int nLine=112, unsigned int pReserved=0)&nbsp; Line 112 + 0x7 bytes&nbsp;C++<br>&nbsp;&nbsp;midiio2k.ocx!std::_Deque_const_iterator&lt;LPQueueStreamMList,std::allocator&lt;LPQueueStreamMList&gt;,1&gt;::operator*()&nbsp; Line 112 + 0x41 bytes&nbsp;C++<br>&nbsp;&nbsp;midiio2k.ocx!std::_Deque_iterator&lt;LPQueueStreamMList,std::allocator&lt;LPQueueStreamMList&gt;,1&gt;::operator*()&nbsp; Line 387&nbsp;C++<br>&nbsp;&nbsp;midiio2k.ocx!std::deque&lt;LPQueueStreamMList,std::allocator&lt;LPQueueStreamMList&gt; &gt;::operator[](unsigned int _Pos=0)&nbsp; Line 775 + 0x3d bytes&nbsp;C++<br>&nbsp;&nbsp;midiio2k.ocx!CMidiOutCtrl::OnResetStateVars()&nbsp; Line 948 + 0x10 bytes&nbsp;C++<br>&nbsp;&nbsp;midiio2k.ocx!CMidiOutCtrl::CMidiOutCtrl()&nbsp; Line 619&nbsp;C++<br>&nbsp;&nbsp;midiio2k.ocx!CMidiOutCtrl::CreateObject()&nbsp; Line 72 + 0x47 bytes&nbsp;C++<br>&nbsp;&nbsp;mfc90d.dll!CRuntimeClass::CreateObject()&nbsp; Line 142 + 0x8 bytes&nbsp;C++<br>&nbsp;&nbsp;mfc90d.dll!COleObjectFactory::OnCreateObject()&nbsp; Line 324 + 0xb bytes&nbsp;C++<br>&nbsp;&nbsp;mfc90d.dll!COleObjectFactory::XClassFactory::CreateInstanceLic(IUnknown * pUnkOuter=0x00000000, IUnknown * __formal=0x00000000, const _GUID &amp; riid={...}, wchar_t * bstrKey=0x00000000, void * * ppvObject=0x002fcee0)&nbsp; Line 547 + 0xd bytes&nbsp;C++<br>&nbsp;&nbsp;mfc90d.dll!COleObjectFactory::XClassFactory::CreateInstance(IUnknown * pUnkOuter=0x00000000, const _GUID &amp; riid={...}, void * * ppvObject=0x002fcee0)&nbsp; Line 464&nbsp;C++<br>&nbsp;&nbsp;ole32.dll!DllGetClassObject()&nbsp; + 0x14b7 bytes&nbsp;<br>&nbsp;&nbsp;[Frames below may be incorrect and/or missing, no symbols loaded for ole32.dll]&nbsp;<br>&nbsp;&nbsp;ole32.dll!CoGetComCatalog()&nbsp; + 0xaba bytes&nbsp;<br>&nbsp;&nbsp;ole32.dll!DllGetClassObject()&nbsp; + 0x15db bytes&nbsp;<br>&nbsp;&nbsp;ole32.dll!DllGetClassObject()&nbsp; + 0x1550 bytes&nbsp;<br>&nbsp;&nbsp;ole32.dll!DllGetClassObject()&nbsp; + 0x139a bytes&nbsp;<br>&nbsp;&nbsp;ole32.dll!DllGetClassObject()&nbsp; + 0x134b bytes&nbsp;<br>&nbsp;&nbsp;ole32.dll!DllGetClassObject()&nbsp; + 0x163e bytes&nbsp;<br>&nbsp;&nbsp;ole32.dll!CoGetComCatalog()&nbsp; + 0xaba bytes&nbsp;<br>&nbsp;&nbsp;ole32.dll!CoGetComCatalog()&nbsp; + 0xb65 bytes&nbsp;<br>&nbsp;&nbsp;ole32.dll!CoGetComCatalog()&nbsp; + 0xaba bytes&nbsp;<br>&nbsp;&nbsp;ole32.dll!CoGetComCatalog()&nbsp; + 0x9ba bytes&nbsp;<br>&nbsp;&nbsp;ole32.dll!CoCreateInstanceEx()&nbsp; + 0xd7 bytes&nbsp;<br>&nbsp;&nbsp;ole32.dll!CoCreateInstanceEx()&nbsp; + 0x38 bytes&nbsp;<br>&nbsp;&nbsp;ole32.dll!CoCreateInstance()&nbsp; + 0x34 bytes&nbsp;<br>&nbsp;&nbsp;[Managed to Native Transition]&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.AxHost.CreateWithoutLicense(System.Guid clsid) + 0x2e bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.AxHost.CreateWithLicense(string license, System.Guid clsid) + 0xb5 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.AxHost.CreateInstanceCore(System.Guid clsid) + 0x29 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.AxHost.CreateInstance() + 0x3f bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.AxHost.GetOcxCreate() + 0x16 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.AxHost.TransitionUpTo(int state = 2) + 0xd2 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.AxHost.CreateHandle() + 0x26 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Control.CreateControl(bool fIgnoreVisible = false) + 0x8a bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Control.CreateControl() + 0x24 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Control.ControlCollection.Add(System.Windows.Forms.Control value = {AxMidiioLib.AxMIDIOutput}) + 0x147 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Form.ControlCollection.Add(System.Windows.Forms.Control value) + 0x3b bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Control.ParentInternal.set(System.Windows.Forms.Control value) + 0x29 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Control.Parent.set(System.Windows.Forms.Control value) + 0xb bytes&nbsp;<br>&nbsp;&nbsp;Kurzweil Librarian Editor.exe!Kurzweil_Librarian_Editor.MIDI_Interface.Get_All_MIDI_Out_Ports(Object sender = {Kurzweil_Librarian_Editor.MIDISysex}) Line 894 + 0x4e bytes&nbsp;Basic<br>&nbsp;&nbsp;Kurzweil Librarian Editor.exe!Kurzweil_Librarian_Editor.MIDISysex.ToolStripTextBox4_Click(Object sender = {System.Windows.Forms.ToolStripTextBox}, System.EventArgs e = {X = 317 Y = 4 Button = System.Windows.Forms.MouseButtons.Left}) Line 1375 + 0xe bytes&nbsp;Basic<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.ToolStripItem.RaiseEvent(object key, System.EventArgs e) + 0x58 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.ToolStripItem.OnClick(System.EventArgs e) + 0x24 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.ToolStripControlHost.HandleClick(object sender, System.EventArgs e) + 0xe bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Control.OnClick(System.EventArgs e) + 0x70 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.TextBoxBase.OnMouseUp(System.Windows.Forms.MouseEventArgs mevent = {X = 317 Y = 4 Button = Left}) + 0x77 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Control.WmMouseUp(ref System.Windows.Forms.Message m, System.Windows.Forms.MouseButtons button, int clicks) + 0x28f bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m) + 0x885 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.TextBoxBase.WndProc(ref System.Windows.Forms.Message m) + 0x37 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.TextBox.WndProc(ref System.Windows.Forms.Message m) + 0x93 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.ToolStripTextBox.ToolStripTextBoxControl.WndProc(ref System.Windows.Forms.Message m) + 0x11 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Control.ControlNativeWindow.OnMessage(ref System.Windows.Forms.Message m) + 0x10 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message m) + 0x31 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.NativeWindow.DebuggableCallback(System.IntPtr hWnd, int msg = 514, System.IntPtr wparam, System.IntPtr lparam) + 0x57 bytes&nbsp;<br>&nbsp;&nbsp;[Native to Managed Transition]&nbsp;<br>&nbsp;&nbsp;user32.dll!GetWindowLongW()&nbsp; + 0x4b3 bytes&nbsp;<br>&nbsp;&nbsp;user32.dll!GetWindowLongW()&nbsp; + 0x58b bytes&nbsp;<br>&nbsp;&nbsp;user32.dll!GetMessageW()&nbsp; + 0x296 bytes&nbsp;<br>&nbsp;&nbsp;user32.dll!DispatchMessageW()&nbsp; + 0xf bytes&nbsp;<br>&nbsp;&nbsp;[Managed to Native Transition]&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(int dwComponentID, int reason = -1, int pvLoopData = 0) + 0x24e bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(int reason = -1, System.Windows.Forms.ApplicationContext context = {Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.WinFormsAppContext}) + 0x177 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Application.ThreadContext.RunMessageLoop(int reason, System.Windows.Forms.ApplicationContext context) + 0x61 bytes&nbsp;<br>&nbsp;&nbsp;System.Windows.Forms.dll!System.Windows.Forms.Application.Run(System.Windows.Forms.ApplicationContext context) + 0x18 bytes&nbsp;<br>&nbsp;&nbsp;Microsoft.VisualBasic.dll!Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.OnRun() + 0x81 bytes&nbsp;<br>&nbsp;&nbsp;Microsoft.VisualBasic.dll!Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.DoApplicationModel() + 0xef bytes&nbsp;<br>&nbsp;&nbsp;Microsoft.VisualBasic.dll!Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Run(string[] commandLine) + 0x68 bytes&nbsp;<br>&nbsp;&nbsp;mscoree.dll!_CorExeMain()&nbsp; + 0x34 bytes&nbsp;<br>&nbsp;&nbsp;kernel32.dll!BaseThreadInitThunk()&nbsp; + 0x12 bytes&nbsp;<br>&nbsp;&nbsp;ntdll.dll!RtlInitializeExceptionChain()&nbsp; + 0x63 bytes&nbsp;<br>&nbsp;&nbsp;ntdll.dll!RtlInitializeExceptionChain()&nbsp; + 0x36 bytes&nbsp;</p>\r\n<p>I went through Dependency Walker to check dependencies.&nbsp; These issues turned up:</p>\r\n<p>MSVCR90D.DLL - Not Found<br>IESHIMS.DLL - Not Found</p>\r\n<p>c:\\windows\\system32\\IEFRAME.DLL</p>\r\n<p>#160 - Not Bound<br>#159 - Not Bound<br>#141 - Not Bound</p>\r\n<p>I believe that MSVCR90D.DLL is the debug run time (Microsoft&reg; C Runtime Library, v. 9.0.30729.1).<br>It was not in the system32 directory.&nbsp; I retrived these files and paced them the system32 directory.&nbsp; I still have the &quot;Not Bound&quot; issues for:</p>\r\n<p>#159<br>#141<br>#160<br>#165<br>#167<br>#142</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-10-19T13:27:16.473-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]